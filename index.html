<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit DOJ Forms</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.min.js"></script>
</head>
<body>
    <div class="container">
        <h1>Edit DOJ Forms</h1>
        <p>Select a form to open and edit:</p>
        <div class="buttons-container" id="pdfList">
            <!-- PDF buttons will go here -->
        </div>

        <div id="pdfEditor" style="display:none;">
            <h2>Editing PDF: <span id="currentPdfName"></span></h2>
            <canvas id="pdfCanvas" width="600" height="800"></canvas>
            <br/>
            <button id="downloadPdf" style="display:none;">Download Edited PDF</button>
        </div>
    </div>

    <script>
        const pdfFiles = [
            'Answer to Complaint.pdf',
            'Appearance.pdf',
            'Application for a Search Warrant.pdf',
            'Appointment of Counsel.pdf',
            'Arrest Warrant.pdf',
            'Civil Complaint.pdf',
            'Court Response to Motion.pdf',
            'Criminal Complaint.pdf',
            'Judgement in a Civil Action.pdf',
            'Motion for Contempt.pdf',
            'Motion for Enlargement of Time.pdf',
            'Motion to Dismiss.pdf',
            'Motion to Reconsider.pdf',
            'Name Change Request.pdf',
            'Notice of Suit.pdf',
            'Pre Filing.pdf',
            'Response to Motion.pdf',
            'Search and Seizure Warrant.pdf',
            'Subpoena Discovery.pdf',
            'Subpoena to Testify at Criminal.pdf',
            'Subpoena to Testify.pdf',
            'Substitution of Attorney.pdf'
        ];

        const pdfFolder = './pdfs/';
        const pdfList = document.getElementById('pdfList');
        const canvas = document.getElementById('pdfCanvas');
        const currentPdfNameSpan = document.getElementById('currentPdfName');
        const pdfEditor = document.getElementById('pdfEditor');
        let pdfDoc = null;

        // Create buttons dynamically for each PDF
        pdfFiles.forEach(pdf => {
            const button = document.createElement('button');
            button.innerText = pdf.replace('.pdf', ''); // Button text without '.pdf'
            button.className = 'pdf-button';
            button.onclick = () => openPdfEditor(pdf);
            pdfList.appendChild(button);
        });

        async function openPdfEditor(pdfFileName) {
            const pdfUrl = pdfFolder + pdfFileName;
            currentPdfNameSpan.innerText = pdfFileName;
            pdfEditor.style.display = 'block';

            const loadingTask = pdfjsLib.getDocument(pdfUrl);
            loadingTask.promise.then(function(pdf) {
                console.log('PDF loaded:', pdfUrl);
                // Fetch the first page
                pdf.getPage(1).then(function(page) {
                    console.log('Page loaded');
                    const scale = 1.5;
                    const viewport = page.getViewport({ scale: scale });

                    // Prepare canvas using PDF page dimensions
                    const canvasContext = canvas.getContext('2d');
                    canvas.height = viewport.height;
                    canvas.width = viewport.width;

                    // Render PDF page into canvas context
                    const renderContext = {
                        canvasContext: canvasContext,
                        viewport: viewport
                    };
                    page.render(renderContext).promise.then(function() {
                        console.log('Page rendered');
                    });
                }).catch(error => {
                    console.error('Error loading page:', error);
                });
            }).catch(error => {
                console.error('Error loading PDF:', error);
            });
        }
    </script>
</body>
</html>
